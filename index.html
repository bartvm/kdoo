<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KDOO Game</title>
    <style>
        /* Global reset for box-sizing */
        * {
            box-sizing: border-box;
        }

        body {
            background-color: #f8f8f0; /* Off-white */
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center; /* Center .game-container and .controls horizontally */
            justify-content: center; /* Center content vertically */
            min-height: 100vh;
            margin: 0;
            padding: 0 10px; /* Add some padding to body to prevent content hitting edges */
            color: #333;
            overflow-x: hidden; /* Prevent horizontal scrolling on body */
        }

        .game-container {
            display: flex;
            align-items: baseline; /* Align items based on their text baseline */
            justify-content: center; /* Center flex items (inputs, span) */
            margin-bottom: 40px;
            width: 100%; /* Take full available width from parent */
            max-width: 700px; /* Optional: constrain max width on very large screens */
        }

        .input-text {
            font-size: 2.5em;
            border: none;
            background-color: transparent;
            outline: none;
            padding: 5px;
            width: auto; /* Size to content */
            min-width: 0; /* Allow to shrink fully if needed by flexbox */
            flex-grow: 0; /* Don't grow beyond content */
            flex-shrink: 1; /* Allow to shrink */
            color: #888; /* Grey color to match unsolved given letters */
            font-weight: normal; /* Inputs are not bold initially */
            /* Color transition removed for input to potentially fix iOS issue, color change will be instant */
            transition: font-weight 0.3s ease; 
            text-transform: uppercase; /* Ensure typed text is uppercase */
        }

        #input-before {
            text-align: right;
        }

        #input-after {
            text-align: left;
        }

        .input-text::placeholder {
            color: #ccc;
            text-transform: none; /* Keep placeholder as is, if needed */
        }
        
        .input-text:focus {
             caret-color: #333; /* Keep caret visible */
        }

        #given-letters {
            font-size: 2.5em;
            font-weight: bold; /* Given letters are always bold */
            color: #888;
            padding: 0 10px; /* Keep some padding */
            user-select: none;
            transition: color 0.3s ease, font-weight 0.3s ease; /* Keep full transition for given letters */
            text-transform: uppercase; /* Ensure given letters are also styled uppercase */
            flex-shrink: 0; /* Prevent given letters from shrinking too much */
            text-align: center; /* Ensure text within span is centered */
            line-height: 1; /* Adjust line-height for potentially better baseline alignment with inputs */
        }

        /* --- Style for the SOLVED state --- */
        .game-container.solved .input-text,
        .game-container.solved #given-letters {
            color: #000; /* All letters turn black */
            font-weight: bold; /* All letters turn bold */
        }


        .controls {
            display: flex;
            justify-content: center; /* Center buttons within the controls div */
            gap: 15px;
            width: 100%; /* Take full available width */
            max-width: 700px; /* Optional: same as game-container */
        }

        .button {
            padding: 10px 20px;
            font-size: 1em;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #fff;
            cursor: pointer;
            transition: background-color 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .button:hover {
            background-color: #f0f0f0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .button:active {
            background-color: #e0e0e0;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        /* Mobile responsiveness adjustments */
        @media (max-width: 600px) {
            body {
                padding: 0 5px; /* Reduce body padding on smaller screens */
            }
            .input-text, #given-letters {
                font-size: 1.5em; /* Further reduce font size for small screens to prevent overflow */
            }
            #given-letters {
                 padding: 0 5px; /* Reduce padding around given letters */
            }
            
            .game-container {
                margin-bottom: 30px; /* Adjust margin */
            }
             .controls {
                flex-direction: column; 
                align-items: center; /* This centers buttons when stacked */
                gap: 10px; /* Adjust gap for stacked buttons */
            }
            .button {
                width: 90%; /* Make buttons a bit wider relative to controls container */
                max-width: 280px; 
            }
        }
        /* Even smaller screens adjustments */
        @media (max-width: 360px) {
             .input-text, #given-letters {
                font-size: 1.3em; /* Even smaller font for very narrow screens */
            }
            #given-letters {
                 padding: 0 3px;
            }
        }

    </style>
</head>
<body>

    <div class="game-container">
        <input type="text" id="input-before" class="input-text" placeholder="">
        <span id="given-letters"></span>
        <input type="text" id="input-after" class="input-text" placeholder="">
    </div>

    <div class="controls">
        <button id="new-button" class="button">New</button>
        <button id="reset-button" class="button">Reset</button>
        <button id="solution-button" class="button">Solution</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- List of all available problems ---
            const problemsList = [
                { given: "RLDW", solution: "WORLDWIDE" },
                { given: "ETPL", solution: "MARKETPLACE" },
                { given: "UIPM", solution: "EQUIPMENT" },
                { given: "CKGR", solution: "BACKGROUND" },
                { given: "HNIQ", solution: "TECHNIQUE" },
                { given: "DITU", solution: "EXPENDITURE" },
                { given: "OTWI", solution: "NOTWITHSTANDING" },
                { given: "LOPM", solution: "DEVELOPMENT" },
                { given: "LTHC", solution: "HEALTHCARE" },
                { given: "WSPA", solution: "NEWSPAPER" },
                { given: "OWJO", solution: "BLOWJOB" },
                { given: "HDRA", solution: "WITHDRAW" },
                { given: "RLIA", solution: "PARLIAMENT" },
                { given: "ADQU", solution: "HEADQUARTER" },
                { given: "RTFO", solution: "PORTFOLIO" },
                { given: "EDGM", solution: "ACKNOWLEDGMENT" },
                { given: "PTCY", solution: "BANKRUPTCY" },
                { given: "NWID", solution: "NATIONWIDE" },
                { given: "MBNA", solution: "THUMBNAIL" },
                { given: "DTRA", solution: "SOUNDTRACK" },
                { given: "ESKT", solution: "DESKTOP" },
                { given: "PPOI", solution: "APPOINT" }
            ];

            let currentProblem = null;
            let currentProblemIndex = -1;

            // --- DOM Elements ---
            const gameContainer = document.querySelector('.game-container'); 
            const inputBefore = document.getElementById('input-before');
            const givenLettersSpan = document.getElementById('given-letters');
            const inputAfter = document.getElementById('input-after');
            const newButton = document.getElementById('new-button');
            const resetButton = document.getElementById('reset-button');
            const solutionButton = document.getElementById('solution-button');

            // --- Game State ---
            let isSolved = false;

            // --- Select a New Problem ---
            function selectNewProblem() {
                if (problemsList.length === 0) {
                    givenLettersSpan.textContent = "Error";
                    return;
                }
                let newIndex;
                if (problemsList.length === 1) {
                    newIndex = 0;
                } else {
                    do {
                        newIndex = Math.floor(Math.random() * problemsList.length);
                    } while (newIndex === currentProblemIndex && problemsList.length > 1);
                }
                currentProblemIndex = newIndex;
                currentProblem = problemsList[currentProblemIndex];
                initializeGame();
            }

            // --- Initialize Game for the currentProblem ---
            function initializeGame() {
                if (!currentProblem) {
                    if (problemsList.length > 0) selectNewProblem();
                    return;
                }
                gameContainer.classList.remove('solved'); 
                givenLettersSpan.textContent = currentProblem.given.toUpperCase(); 
                inputBefore.value = '';
                inputAfter.value = '';
                inputBefore.placeholder = '...'; 
                inputAfter.placeholder = '...';  
                inputBefore.disabled = false;
                inputAfter.disabled = false;
                inputBefore.focus(); 
                isSolved = false;
            }

            // --- Check Input ---
            function checkInput() {
                if (!currentProblem) return; 

                const beforeText = inputBefore.value.toUpperCase();
                const afterText = inputAfter.value.toUpperCase();
                const givenText = currentProblem.given.toUpperCase(); 
                const solutionText = currentProblem.solution.toUpperCase();
                const formedWord = beforeText + givenText + afterText;

                if (formedWord === solutionText) {
                    if (!isSolved) { 
                        gameContainer.classList.add('solved'); 
                        isSolved = true;
                        inputBefore.disabled = true;
                        inputAfter.disabled = true;
                    }
                } else {
                    if (isSolved) { 
                        gameContainer.classList.remove('solved'); 
                        isSolved = false;
                        inputBefore.disabled = false;
                        inputAfter.disabled = false;
                    }
                }
            }

            // --- Event Listeners ---
            inputBefore.addEventListener('input', checkInput);
            inputAfter.addEventListener('input', checkInput);
            newButton.addEventListener('click', selectNewProblem);
            resetButton.addEventListener('click', () => {
                if (currentProblem) initializeGame();
            });
            solutionButton.addEventListener('click', () => {
                if (!currentProblem) return;
                const solution = currentProblem.solution;
                const given = currentProblem.given;
                const indexOfGiven = solution.toUpperCase().indexOf(given.toUpperCase());
                if (indexOfGiven !== -1) {
                    inputBefore.value = solution.substring(0, indexOfGiven);
                    inputAfter.value = solution.substring(indexOfGiven + given.length);
                } else {
                    inputBefore.value = '';
                    inputAfter.value = solution;
                }
                checkInput(); 
            });

            // --- Start the game by selecting the first problem ---
            selectNewProblem(); 
        });
    </script>
</body>
</html>
